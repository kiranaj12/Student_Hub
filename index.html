<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student-Hub - AI-Powered Student Management</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4F46E5">
    <meta name="description" content="AI-powered student details management system">
    <link rel="manifest" id="manifest-placeholder">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for AI Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 50%, #ec4899 100%);
        }
        .glass-effect {
            backdrop-filter: blur(15px);
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .ai-glow {
            box-shadow: 0 0 20px rgba(79, 70, 229, 0.3);
        }
        .install-pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- PWA Install Banner -->
    <div id="installBanner" class="fixed top-0 left-0 right-0 z-50 bg-indigo-600 text-white p-4 text-center install-pulse" style="display: none;">
        <div class="flex items-center justify-center space-x-4">
            <i class="fas fa-mobile-alt text-xl"></i>
            <span class="font-semibold">Install Student-Hub on your device for the best experience!</span>
            <button id="installBtn" class="bg-white text-indigo-600 px-4 py-2 rounded-lg font-bold hover:bg-gray-100 transition-colors">
                <i class="fas fa-download mr-2"></i>Install App
            </button>
            <button id="dismissInstall" class="text-white hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Enhanced Mobile Install Popup -->
    <div id="installPopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
        <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center shadow-2xl">
            <div class="mb-6">
                <div class="w-20 h-20 bg-indigo-600 rounded-2xl mx-auto mb-4 flex items-center justify-center animate-pulse">
                    <i class="fas fa-graduation-cap text-3xl text-white"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Install Student-Hub</h3>
                <p class="text-gray-600">Get the full app experience on your device</p>
            </div>
            
            <div class="space-y-3 mb-6 text-left">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-check-circle text-green-500"></i>
                    <span class="text-gray-700">Work offline</span>
                </div>
                <div class="flex items-center space-x-3">
                    <i class="fas fa-check-circle text-green-500"></i>
                    <span class="text-gray-700">Fast loading</span>
                </div>
                <div class="flex items-center space-x-3">
                    <i class="fas fa-check-circle text-green-500"></i>
                    <span class="text-gray-700">Home screen access</span>
                </div>
                <div class="flex items-center space-x-3">
                    <i class="fas fa-check-circle text-green-500"></i>
                    <span class="text-gray-700">Push notifications</span>
                </div>
            </div>
            
            <div class="space-y-3">
                <button id="installPopupBtn" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-bold hover:bg-indigo-700 transition-colors transform hover:scale-105">
                    <i class="fas fa-download mr-2"></i>Install Now
                </button>
                <button id="dismissPopup" class="w-full text-gray-500 hover:text-gray-700 transition-colors">
                    Maybe Later
                </button>
            </div>
        </div>
    </div>

    <!-- Floating Install Button -->
    <div id="floatingInstall" class="fixed bottom-4 right-4 z-40" style="display: none;">
        <button onclick="handleInstall()" class="bg-indigo-600 text-white p-4 rounded-full shadow-lg hover:bg-indigo-700 transition-colors install-pulse">
            <i class="fas fa-download text-xl"></i>
        </button>
    </div>

    <!-- Authentication Section -->
    <div id="authSection" class="container mx-auto px-4 py-8">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="text-center mb-8">
            <div class="glass-effect rounded-2xl p-8 ai-glow max-w-md mx-auto">
                <h1 class="text-3xl font-bold text-white mb-2">
                    <i class="fas fa-graduation-cap mr-3"></i>Student-Hub
                </h1>
                <p class="text-gray-200 text-lg font-semibold mb-2">SREE SIDDRAMESHWARA POLYTECHNIC TIPTUR</p>
                <p class="text-gray-300 text-sm mb-6">Diploma Student Management System</p>
                <div class="space-y-4">
                    <button onclick="showAuthForm('signin')" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all">
                        <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                    </button>
                    <button onclick="showAuthForm('signup')" class="w-full bg-gradient-to-r from-green-600 to-teal-600 text-white font-bold py-3 px-6 rounded-lg hover:from-green-700 hover:to-teal-700 transition-all">
                        <i class="fas fa-user-plus mr-2"></i>Register
                    </button>
                </div>
            </div>
        </div>

        <!-- Sign In Form -->
        <div id="signinForm" class="glass-effect rounded-xl p-8 max-w-md mx-auto" style="display: none;">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">
                <i class="fas fa-sign-in-alt mr-2"></i>Sign In
            </h2>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-white font-semibold mb-2">Username *</label>
                    <input type="text" id="loginId" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none" placeholder="Enter your username">
                </div>

                <div>
                    <label class="block text-white font-semibold mb-2">Password *</label>
                    <input type="password" id="loginPassword" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none" placeholder="Enter your password">
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all">
                    <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                </button>
            </form>

            <div class="text-center mt-6">
                <button onclick="showAuthForm('signup')" class="text-blue-300 hover:text-blue-200 underline">
                    Don't have an account? Register here
                </button>
                <br>
                <button onclick="showAuthForm('welcome')" class="text-gray-300 hover:text-gray-200 underline mt-2">
                    Back to Welcome
                </button>
            </div>
            
            <!-- Demo Credentials -->
            <div class="mt-6 p-4 bg-blue-600/20 rounded-lg border border-blue-400/30">
                <h4 class="text-blue-300 font-semibold mb-2">Demo Credentials:</h4>
                <p class="text-blue-200 text-sm">Admin: <strong>admin</strong> / <strong>admin123</strong></p>
                <p class="text-blue-200 text-sm">Student: <strong>rahul_kumar</strong> / <strong>student123</strong></p>
            </div>
        </div>

        <!-- Sign Up Form -->
        <div id="signupForm" class="glass-effect rounded-xl p-8 max-w-2xl mx-auto" style="display: none;">
            <h2 class="text-2xl font-bold text-white mb-6 text-center">
                <i class="fas fa-user-plus mr-2"></i>Register New Account
            </h2>
            
            <form id="registerForm" class="space-y-6">
                <div>
                    <label class="block text-white font-semibold mb-2">Account Type *</label>
                    <select id="accountType" required class="w-full p-3 rounded-lg bg-white text-gray-800 border border-gray-300 focus:border-blue-400 focus:outline-none" onchange="toggleAccountFields()">
                        <option value="">Select Account Type</option>
                        <option value="student">Student</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">Full Name *</label>
                        <input type="text" id="regFullName" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Username *</label>
                        <input type="text" id="regNumber" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none" placeholder="e.g., john_doe">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">Email *</label>
                        <input type="email" id="regEmail" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Phone Number</label>
                        <input type="tel" id="regPhone" class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none">
                    </div>
                </div>

                <div id="studentFields" class="space-y-4" style="display: none;">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-white font-semibold mb-2">Department *</label>
                            <select id="regDepartment" class="w-full p-3 rounded-lg bg-white text-gray-800 border border-gray-300 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Department</option>
                                <option value="CSE">Computer Science and Engineering</option>
                                <option value="EC">Electronics and Communication</option>
                                <option value="ME">Mechanical Engineering</option>
                                <option value="CE">Civil Engineering</option>
                                <option value="EE">Electrical Engineering</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Year *</label>
                            <select id="regYear" class="w-full p-3 rounded-lg bg-white text-gray-800 border border-gray-300 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Year</option>
                                <option value="1">1st Year</option>
                                <option value="2">2nd Year</option>
                                <option value="3">3rd Year</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Semester *</label>
                            <select id="regSemester" class="w-full p-3 rounded-lg bg-white text-gray-800 border border-gray-300 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Semester</option>
                                <option value="1">1st Semester</option>
                                <option value="2">2nd Semester</option>
                                <option value="3">3rd Semester</option>
                                <option value="4">4th Semester</option>
                                <option value="5">5th Semester</option>
                                <option value="6">6th Semester</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="adminFields" class="space-y-4" style="display: none;">
                    <div>
                        <label class="block text-white font-semibold mb-2">Role Type *</label>
                        <select id="regRole" class="w-full p-3 rounded-lg bg-white text-gray-800 border border-gray-300 focus:border-blue-400 focus:outline-none">
                            <option value="">Select Role</option>
                            <option value="Teacher">Teacher</option>
                            <option value="HOD">Head of Department (HOD)</option>
                            <option value="Dean">Dean</option>
                            <option value="Principal">Principal</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">Password *</label>
                        <input type="password" id="regPassword" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none" minlength="6">
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Confirm Password *</label>
                        <input type="password" id="regConfirmPassword" required class="w-full p-3 rounded-lg bg-white text-gray-800 placeholder-gray-500 border border-gray-300 focus:border-blue-400 focus:outline-none" minlength="6">
                    </div>
                </div>

                <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-teal-600 text-white font-bold py-3 px-6 rounded-lg hover:from-green-700 hover:to-teal-700 transition-all">
                    <i class="fas fa-user-plus mr-2"></i>Create Account
                </button>
            </form>

            <div class="text-center mt-6">
                <button onclick="showAuthForm('signin')" class="text-blue-300 hover:text-blue-200 underline">
                    Already have an account? Sign in here
                </button>
                <br>
                <button onclick="showAuthForm('welcome')" class="text-gray-300 hover:text-gray-200 underline mt-2">
                    Back to Welcome
                </button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="container mx-auto px-4 py-8" style="display: none;">
        <!-- Header -->
        <header class="text-center mb-8 slide-in">
            <div class="glass-effect rounded-2xl p-6 ai-glow">
                <div class="flex justify-between items-center">
                    <div class="flex-1">
                        <h1 class="text-4xl font-bold text-white mb-2">
                            <i class="fas fa-graduation-cap mr-3"></i>Student-Hub
                        </h1>
                        <p class="text-gray-200 text-lg">SREE SIDDRAMESHWARA POLYTECHNIC TIPTUR</p>
                        <p class="text-gray-300 text-sm">Diploma Student Management System</p>
                    </div>
                    <div class="text-right">
                        <p class="text-white font-semibold" id="userWelcome">Welcome!</p>
                        <p class="text-gray-300 text-sm" id="userRole"></p>
                        <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors mt-2">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="mb-8">
            <div class="glass-effect rounded-xl p-4">
                <div id="adminNav" class="flex flex-wrap justify-center space-x-2 space-y-2">
                    <button onclick="showSection('dashboard')" class="nav-btn bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors cursor-pointer">
                        <i class="fas fa-chart-line mr-2"></i>Dashboard
                    </button>
                    <button onclick="showSection('addStudent')" class="nav-btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors cursor-pointer">
                        <i class="fas fa-user-plus mr-2"></i>Add Student
                    </button>
                    <button onclick="showSection('viewStudents')" class="nav-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">
                        <i class="fas fa-users mr-2"></i>View Students
                    </button>
                    <button onclick="showSection('analytics')" class="nav-btn bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors cursor-pointer">
                        <i class="fas fa-chart-bar mr-2"></i>Analytics
                    </button>
                    <button onclick="showSection('reports')" class="nav-btn bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors cursor-pointer">
                        <i class="fas fa-file-alt mr-2"></i>Reports
                    </button>
                    <button onclick="showSection('settings')" class="nav-btn bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors cursor-pointer">
                        <i class="fas fa-cog mr-2"></i>Settings
                    </button>
                </div>
                <div id="studentNav" class="flex flex-wrap justify-center space-x-2 space-y-2" style="display: none;">
                    <button onclick="showSection('studentDashboard')" class="nav-btn bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors cursor-pointer">
                        <i class="fas fa-chart-line mr-2"></i>My Dashboard
                    </button>
                    <button onclick="showSection('profile')" class="nav-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">
                        <i class="fas fa-user mr-2"></i>Profile
                    </button>
                    <button onclick="showSection('grades')" class="nav-btn bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors cursor-pointer">
                        <i class="fas fa-graduation-cap mr-2"></i>Grades
                    </button>
                    <button onclick="showSection('attendance')" class="nav-btn bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors cursor-pointer">
                        <i class="fas fa-calendar-check mr-2"></i>Attendance
                    </button>
                    <button onclick="showSection('assignments')" class="nav-btn bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors cursor-pointer">
                        <i class="fas fa-tasks mr-2"></i>Assignments
                    </button>
                    <button onclick="showSection('notifications')" class="nav-btn bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors cursor-pointer">
                        <i class="fas fa-bell mr-2"></i>Notifications
                    </button>
                </div>
            </div>
        </nav>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="glass-effect rounded-xl p-6 text-white text-center">
                    <i class="fas fa-users text-3xl mb-3 text-blue-300"></i>
                    <h3 class="text-2xl font-bold" id="totalStudents">0</h3>
                    <p class="text-gray-300">Total Students</p>
                </div>
                <div class="glass-effect rounded-xl p-6 text-white text-center">
                    <i class="fas fa-chart-line text-3xl mb-3 text-green-300"></i>
                    <h3 class="text-2xl font-bold" id="avgGrade">0</h3>
                    <p class="text-gray-300">Average Grade</p>
                </div>
                <div class="glass-effect rounded-xl p-6 text-white text-center">
                    <i class="fas fa-trophy text-3xl mb-3 text-yellow-300"></i>
                    <h3 class="text-2xl font-bold" id="topPerformers">0</h3>
                    <p class="text-gray-300">Top Performers</p>
                </div>
                <div class="glass-effect rounded-xl p-6 text-white text-center">
                    <i class="fas fa-robot text-3xl mb-3 text-purple-300"></i>
                    <h3 class="text-2xl font-bold">AI</h3>
                    <p class="text-gray-300">Predictions Ready</p>
                </div>
            </div>

            <!-- AI Analytics Dashboard -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">
                        <i class="fas fa-chart-bar mr-2"></i>Department Performance
                    </h3>
                    <canvas id="departmentChart" width="400" height="200"></canvas>
                </div>
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">
                        <i class="fas fa-chart-pie mr-2"></i>Grade Distribution
                    </h3>
                    <canvas id="gradeChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Recent Activities -->
            <div class="glass-effect rounded-xl p-6">
                <h3 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-clock mr-2"></i>Recent Activities
                </h3>
                <div id="recentActivities" class="space-y-3">
                    <!-- Activities will be populated here -->
                </div>
            </div>
        </section>

        <!-- Add Student Section -->
        <section id="addStudent" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-8 max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold text-white mb-6 text-center">
                    <i class="fas fa-user-plus mr-2"></i>Add New Student
                </h2>
                
                <form id="studentForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-white font-semibold mb-2">Full Name *</label>
                            <input type="text" id="fullName" required class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-gray-300 border border-white/30 focus:border-blue-400 focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Student ID *</label>
                            <input type="text" id="studentId" required class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-gray-300 border border-white/30 focus:border-blue-400 focus:outline-none">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-white font-semibold mb-2">Email *</label>
                            <input type="email" id="email" required class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-gray-300 border border-white/30 focus:border-blue-400 focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Phone</label>
                            <input type="tel" id="phone" class="w-full p-3 rounded-lg bg-white/20 text-white placeholder-gray-300 border border-white/30 focus:border-blue-400 focus:outline-none">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-white font-semibold mb-2">Department *</label>
                            <select id="department" required class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Department</option>
                                <option value="CSE">Computer Science and Engineering</option>
                                <option value="EC">Electronics and Communication</option>
                                <option value="ME">Mechanical Engineering</option>
                                <option value="CE">Civil Engineering</option>
                                <option value="EE">Electrical Engineering</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Year *</label>
                            <select id="year" required class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Year</option>
                                <option value="1">1st Year</option>
                                <option value="2">2nd Year</option>
                                <option value="3">3rd Year</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Semester</label>
                            <select id="semester" class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30 focus:border-blue-400 focus:outline-none">
                                <option value="">Select Semester</option>
                                <option value="1">1st Semester</option>
                                <option value="2">2nd Semester</option>
                                <option value="3">3rd Semester</option>
                                <option value="4">4th Semester</option>
                                <option value="5">5th Semester</option>
                                <option value="6">6th Semester</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all ai-glow">
                        <i class="fas fa-plus mr-2"></i>Add Student
                    </button>
                </form>
            </div>
        </section>

        <!-- View Students Section -->
        <section id="viewStudents" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-users mr-2"></i>Student Records
                </h2>

                <div class="overflow-x-auto">
                    <table class="w-full text-white">
                        <thead>
                            <tr class="border-b border-white/30">
                                <th class="text-left p-3">Name</th>
                                <th class="text-left p-3">ID</th>
                                <th class="text-left p-3">Department</th>
                                <th class="text-left p-3">Year</th>
                                <th class="text-left p-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTable">
                            <!-- Students will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Student Dashboard -->
        <section id="studentDashboard" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6 mb-6 text-center">
                <h2 class="text-3xl font-bold mb-2" id="dashboardWelcome">Welcome Back!</h2>
                <p class="text-lg" id="dashboardStudentInfo">Loading your academic overview...</p>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6 mb-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-chart-bar mr-2"></i>Advanced Analytics
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="glass-effect rounded-xl p-6">
                        <h3 class="text-xl font-bold text-white mb-4">Performance Trends</h3>
                        <canvas id="performanceChart" width="400" height="200"></canvas>
                    </div>
                    <div class="glass-effect rounded-xl p-6">
                        <h3 class="text-xl font-bold text-white mb-4">Attendance Analysis</h3>
                        <canvas id="attendanceChart" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">AI Predictions</h3>
                    <div id="aiPredictions" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- AI predictions will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-file-alt mr-2"></i>Generate Reports
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <i class="fas fa-users text-3xl mb-3 text-blue-300"></i>
                        <h3 class="text-lg font-bold text-white mb-2">Student Report</h3>
                        <button onclick="generateReport('student')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Generate
                        </button>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <i class="fas fa-chart-line text-3xl mb-3 text-green-300"></i>
                        <h3 class="text-lg font-bold text-white mb-2">Performance Report</h3>
                        <button onclick="generateReport('performance')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                            Generate
                        </button>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <i class="fas fa-calendar-check text-3xl mb-3 text-yellow-300"></i>
                        <h3 class="text-lg font-bold text-white mb-2">Attendance Report</h3>
                        <button onclick="generateReport('attendance')" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors">
                            Generate
                        </button>
                    </div>
                </div>
                
                <div id="reportOutput" class="glass-effect rounded-xl p-6" style="display: none;">
                    <h3 class="text-xl font-bold text-white mb-4">Report Output</h3>
                    <div id="reportContent" class="text-white">
                        <!-- Report content will be displayed here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-cog mr-2"></i>System Settings
                </h2>
                
                <div class="space-y-6">
                    <div class="glass-effect rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-4">General Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-white font-semibold mb-2">Institution Name</label>
                                <input type="text" value="SREE SIDDRAMESHWARA POLYTECHNIC TIPTUR" class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Academic Year</label>
                                <select class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                                    <option value="2023-24">2023-24</option>
                                    <option value="2024-25">2024-25</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-effect rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-4">Notification Settings</h3>
                        <div class="space-y-3">
                            <label class="flex items-center text-white">
                                <input type="checkbox" checked class="mr-3">
                                Email notifications for new students
                            </label>
                            <label class="flex items-center text-white">
                                <input type="checkbox" checked class="mr-3">
                                SMS alerts for attendance
                            </label>
                            <label class="flex items-center text-white">
                                <input type="checkbox" class="mr-3">
                                Weekly performance reports
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Student Grades Section -->
        <section id="grades" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-graduation-cap mr-2"></i>My Grades
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Current GPA</h3>
                        <div class="text-4xl font-bold text-green-300" id="studentGPA">3.8</div>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Class Rank</h3>
                        <div class="text-4xl font-bold text-blue-300" id="studentRank">5</div>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Subject Grades</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead>
                                <tr class="border-b border-white/30">
                                    <th class="text-left p-3">Subject</th>
                                    <th class="text-left p-3">Credits</th>
                                    <th class="text-left p-3">Grade</th>
                                    <th class="text-left p-3">Points</th>
                                </tr>
                            </thead>
                            <tbody id="gradesTable">
                                <!-- Grades will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Student Attendance Section -->
        <section id="attendance" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-calendar-check mr-2"></i>My Attendance
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Overall Attendance</h3>
                        <div class="text-4xl font-bold text-green-300" id="overallAttendance">85%</div>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Present Days</h3>
                        <div class="text-4xl font-bold text-blue-300" id="presentDays">170</div>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Absent Days</h3>
                        <div class="text-4xl font-bold text-red-300" id="absentDays">30</div>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Subject-wise Attendance</h3>
                    <div id="attendanceChart2" class="mb-4">
                        <canvas id="subjectAttendanceChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Student Assignments Section -->
        <section id="assignments" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-tasks mr-2"></i>My Assignments
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Pending</h3>
                        <div class="text-4xl font-bold text-yellow-300" id="pendingAssignments">3</div>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Completed</h3>
                        <div class="text-4xl font-bold text-green-300" id="completedAssignments">12</div>
                    </div>
                    <div class="glass-effect rounded-xl p-6 text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Overdue</h3>
                        <div class="text-4xl font-bold text-red-300" id="overdueAssignments">1</div>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Assignment List</h3>
                    <div id="assignmentsList" class="space-y-4">
                        <!-- Assignments will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Student Notifications Section -->
        <section id="notifications" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-6">
                <h2 class="text-2xl font-bold text-white mb-6">
                    <i class="fas fa-bell mr-2"></i>Notifications
                </h2>
                
                <div class="space-y-4" id="notificationsList">
                    <!-- Notifications will be populated here -->
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profile" class="section" style="display: none;">
            <div class="glass-effect rounded-xl p-8 max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold text-white mb-6 text-center">
                    <i class="fas fa-user mr-2"></i>My Profile
                </h2>
                
                <div id="studentProfile" class="space-y-6">
                    <!-- Student profile will be populated here -->
                </div>
            </div>
        </section>
    </div>

    <!-- Success/Error Messages -->
    <div id="messageContainer" class="fixed top-20 right-4 z-40"></div>

    <script>
        // Global Variables
        let students = [];
        let users = [];
        let currentUser = null;
        let currentSection = 'dashboard';
        let deferredPrompt;

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Student-Hub initializing...');
            
            // Initialize sample data
            initializeSampleData();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize PWA features
            initializePWA();
            
            // Check if user is already logged in
            loadCurrentUser();
        });

        // Initialize sample data
        function initializeSampleData() {
            // Load from localStorage or create sample data
            const savedUsers = localStorage.getItem('users');
            const savedStudents = localStorage.getItem('students');
            
            if (savedUsers) {
                users = JSON.parse(savedUsers);
            } else {
                // Create sample admin
                users = [{
                    id: 1,
                    accountType: 'admin',
                    fullName: 'System Administrator',
                    username: 'admin',
                    email: 'admin@sspt.edu.in',
                    phone: '555-0000',
                    role: 'Principal',
                    password: 'admin123',
                    dateCreated: new Date().toISOString()
                }, {
                    id: 2,
                    accountType: 'student',
                    fullName: 'Rahul Kumar',
                    username: 'rahul_kumar',
                    email: 'rahul@sspt.edu.in',
                    phone: '9876543210',
                    department: 'CSE',
                    year: '2',
                    semester: '3',
                    password: 'student123',
                    dateCreated: new Date().toISOString()
                }];
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            if (savedStudents) {
                students = JSON.parse(savedStudents);
            } else {
                // Create sample students
                students = [{
                    id: 2,
                    fullName: "Rahul Kumar",
                    studentId: "485CS23054",
                    username: "rahul_kumar",
                    email: "rahul@sspt.edu.in",
                    phone: "9876543210",
                    department: "CSE",
                    year: "2",
                    semester: "3",
                    gpa: 3.8,
                    dateAdded: new Date().toISOString()
                }];
                localStorage.setItem('students', JSON.stringify(students));
            }
            
            console.log('Sample data initialized:', { users: users.length, students: students.length });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Login form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }

            // Register form
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', handleRegister);
            }

            // Student form
            const studentForm = document.getElementById('studentForm');
            if (studentForm) {
                studentForm.addEventListener('submit', handleAddStudent);
            }
        }

        // Authentication Functions
        function showAuthForm(formType) {
            console.log('Showing form:', formType);
            
            // Hide all forms
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('signinForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'none';
            
            // Show selected form
            if (formType === 'welcome') {
                document.getElementById('welcomeScreen').style.display = 'block';
            } else if (formType === 'signin') {
                document.getElementById('signinForm').style.display = 'block';
            } else if (formType === 'signup') {
                document.getElementById('signupForm').style.display = 'block';
            }
        }

        function toggleAccountFields() {
            const accountType = document.getElementById('accountType').value;
            const studentFields = document.getElementById('studentFields');
            const adminFields = document.getElementById('adminFields');
            
            if (accountType === 'student') {
                studentFields.style.display = 'block';
                adminFields.style.display = 'none';
            } else if (accountType === 'admin') {
                studentFields.style.display = 'none';
                adminFields.style.display = 'block';
            } else {
                studentFields.style.display = 'none';
                adminFields.style.display = 'none';
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            console.log('Login form submitted');
            
            const username = document.getElementById('loginId').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            console.log('Login attempt:', username);
            
            if (!username || !password) {
                showMessage('Please enter both username and password', 'error');
                return;
            }
            
            // Find user
            const user = users.find(u => u.username === username && u.password === password);
            console.log('User found:', user ? 'Yes' : 'No');
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Show main app
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                // Update UI based on user role
                updateUserInterface();
                
                showMessage(`Welcome back, ${user.fullName}!`, 'success');
            } else {
                showMessage('Invalid username or password!', 'error');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            console.log('Register form submitted');
            
            const formData = {
                id: Date.now(),
                accountType: document.getElementById('accountType').value,
                fullName: document.getElementById('regFullName').value.trim(),
                username: document.getElementById('regNumber').value.trim(),
                email: document.getElementById('regEmail').value.trim(),
                phone: document.getElementById('regPhone').value.trim(),
                password: document.getElementById('regPassword').value,
                confirmPassword: document.getElementById('regConfirmPassword').value,
                dateCreated: new Date().toISOString()
            };

            // Add type-specific fields
            if (formData.accountType === 'student') {
                formData.department = document.getElementById('regDepartment').value;
                formData.year = document.getElementById('regYear').value;
                formData.semester = document.getElementById('regSemester').value;
            } else if (formData.accountType === 'admin') {
                formData.role = document.getElementById('regRole').value;
            }

            // Validation
            if (!validateRegistration(formData)) return;

            // Check for duplicate username
            if (users.some(u => u.username === formData.username)) {
                showMessage('Username already exists!', 'error');
                return;
            }

            // Remove confirm password before saving
            delete formData.confirmPassword;

            users.push(formData);
            localStorage.setItem('users', JSON.stringify(users));
            
            // If student, also add to students array
            if (formData.accountType === 'student') {
                const studentData = {
                    id: formData.id,
                    fullName: formData.fullName,
                    studentId: generateStudentId(formData.department, formData.year),
                    username: formData.username,
                    email: formData.email,
                    phone: formData.phone,
                    department: formData.department,
                    year: formData.year,
                    semester: formData.semester,
                    gpa: 0,
                    dateAdded: formData.dateCreated
                };
                students.push(studentData);
                localStorage.setItem('students', JSON.stringify(students));
            }
            
            showMessage('Account created successfully! Please sign in.', 'success');
            showAuthForm('signin');
            document.getElementById('registerForm').reset();
        }

        function validateRegistration(data) {
            if (!data.accountType) {
                showMessage('Please select an account type', 'error');
                return false;
            }
            
            if (!data.fullName || data.fullName.length < 2) {
                showMessage('Please enter a valid full name', 'error');
                return false;
            }
            
            if (!data.username || data.username.length < 3) {
                showMessage('Please enter a valid username', 'error');
                return false;
            }
            
            if (!data.email || !isValidEmail(data.email)) {
                showMessage('Please enter a valid email address', 'error');
                return false;
            }
            
            if (!data.password || data.password.length < 6) {
                showMessage('Password must be at least 6 characters long', 'error');
                return false;
            }
            
            if (data.password !== data.confirmPassword) {
                showMessage('Passwords do not match', 'error');
                return false;
            }
            
            if (data.accountType === 'student') {
                if (!data.department || !data.year || !data.semester) {
                    showMessage('Please fill all student fields', 'error');
                    return false;
                }
            }
            
            if (data.accountType === 'admin') {
                if (!data.role) {
                    showMessage('Please select a role type', 'error');
                    return false;
                }
            }
            
            return true;
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function generateStudentId(department, year) {
            const deptCodes = {
                'CSE': 'CS',
                'EC': 'EC',
                'ME': 'ME',
                'CE': 'CE',
                'EE': 'EE'
            };
            
            const deptCode = deptCodes[department] || 'XX';
            const currentYear = new Date().getFullYear().toString().slice(-2);
            const serial = (students.length + 1).toString().padStart(3, '0');
            
            return `485${deptCode}${currentYear}${serial}`;
        }

        function updateUserInterface() {
            if (!currentUser) return;
            
            document.getElementById('userWelcome').textContent = `Welcome, ${currentUser.fullName}!`;
            document.getElementById('userRole').textContent = currentUser.accountType === 'admin' ? 'Administrator' : 'Student';
            
            if (currentUser.accountType === 'admin') {
                document.getElementById('adminNav').style.display = 'flex';
                document.getElementById('studentNav').style.display = 'none';
                showSection('dashboard');
                updateDashboard();
            } else {
                document.getElementById('adminNav').style.display = 'none';
                document.getElementById('studentNav').style.display = 'flex';
                showSection('studentDashboard');
                updateStudentDashboard();
            }
        }

        function loadCurrentUser() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                updateUserInterface();
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('app').style.display = 'none';
            
            showAuthForm('welcome');
            showMessage('Logged out successfully!', 'success');
        }

        // Navigation
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
            document.getElementById(section).style.display = 'block';
            currentSection = section;
            
            // Update active nav button
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-opacity-100');
                btn.classList.add('bg-opacity-80');
            });
            
            if (section === 'dashboard') {
                updateDashboard();
                initializeCharts();
            } else if (section === 'viewStudents') {
                displayStudents();
            } else if (section === 'studentDashboard') {
                updateStudentDashboard();
            } else if (section === 'profile') {
                loadStudentProfile();
            } else if (section === 'analytics') {
                loadAnalytics();
            } else if (section === 'grades') {
                loadStudentGrades();
            } else if (section === 'attendance') {
                loadStudentAttendance();
            } else if (section === 'assignments') {
                loadStudentAssignments();
            } else if (section === 'notifications') {
                loadNotifications();
            }
        }

        // Student Management
        function handleAddStudent(e) {
            e.preventDefault();
            
            const formData = {
                id: Date.now(),
                fullName: document.getElementById('fullName').value.trim(),
                studentId: document.getElementById('studentId').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                department: document.getElementById('department').value,
                year: document.getElementById('year').value,
                semester: document.getElementById('semester').value,
                gpa: 0,
                dateAdded: new Date().toISOString()
            };

            // Validation
            if (!formData.fullName || !formData.studentId || !formData.email || !formData.department || !formData.year) {
                showMessage('Please fill all required fields', 'error');
                return;
            }

            // Check for duplicate student ID
            if (students.some(s => s.studentId === formData.studentId)) {
                showMessage('Student ID already exists!', 'error');
                return;
            }

            students.push(formData);
            localStorage.setItem('students', JSON.stringify(students));
            
            showMessage('Student added successfully!', 'success');
            document.getElementById('studentForm').reset();
            updateDashboard();
        }

        function displayStudents() {
            const tbody = document.getElementById('studentsTable');
            
            tbody.innerHTML = students.map(student => `
                <tr class="border-b border-white/20 hover:bg-white/10 transition-colors">
                    <td class="p-3">${student.fullName}</td>
                    <td class="p-3">${student.studentId}</td>
                    <td class="p-3">${student.department}</td>
                    <td class="p-3">${student.year}</td>
                    <td class="p-3">
                        <button onclick="deleteStudent(${student.id})" class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition-colors">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteStudent(id) {
            if (confirm('Are you sure you want to delete this student?')) {
                students = students.filter(s => s.id !== id);
                localStorage.setItem('students', JSON.stringify(students));
                displayStudents();
                updateDashboard();
                showMessage('Student deleted successfully', 'success');
            }
        }

        // Dashboard Updates
        function updateDashboard() {
            document.getElementById('totalStudents').textContent = students.length;
            
            const avgGrade = students.length > 0 ? 
                (students.reduce((sum, s) => sum + s.gpa, 0) / students.length).toFixed(2) : '0.00';
            document.getElementById('avgGrade').textContent = avgGrade;
            
            const topPerformers = students.filter(s => s.gpa >= 3.5).length;
            document.getElementById('topPerformers').textContent = topPerformers;
            
            // Update recent activities
            updateRecentActivities();
        }

        function updateStudentDashboard() {
            if (currentUser.accountType !== 'student') return;
            
            const student = students.find(s => s.username === currentUser.username);
            if (student) {
                document.getElementById('dashboardWelcome').textContent = `Welcome, ${student.fullName}!`;
                document.getElementById('dashboardStudentInfo').textContent = 
                    `${student.department} - Year ${student.year}, Semester ${student.semester}`;
            }
        }

        function loadStudentProfile() {
            if (currentUser.accountType !== 'student') return;
            
            const student = students.find(s => s.username === currentUser.username);
            if (!student) return;
            
            const profileHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-white font-semibold mb-2">Full Name</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.fullName}
                        </div>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Student ID</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.studentId}
                        </div>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Email</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.email}
                        </div>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Phone</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.phone || 'Not provided'}
                        </div>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Department</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.department}
                        </div>
                    </div>
                    <div>
                        <label class="block text-white font-semibold mb-2">Year</label>
                        <div class="w-full p-3 rounded-lg bg-white/20 text-white border border-white/30">
                            ${student.year} Year
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('studentProfile').innerHTML = profileHTML;
        }

        // Message System
        function showMessage(message, type) {
            const container = document.getElementById('messageContainer');
            const messageDiv = document.createElement('div');
            
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600'
            };
            
            messageDiv.className = `${colors[type]} text-white px-6 py-3 rounded-lg mb-4 shadow-lg slide-in`;
            messageDiv.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            container.appendChild(messageDiv);
            
            setTimeout(() => {
                if (messageDiv.parentElement) {
                    messageDiv.remove();
                }
            }, 5000);
        }

        // PWA Functions
        function initializePWA() {
            // Generate PWA Manifest
            const manifest = {
                name: "Student-Hub - AI Student Management",
                short_name: "Student-Hub",
                description: "AI-powered student details management system",
                start_url: "/",
                display: "standalone",
                background_color: "#4F46E5",
                theme_color: "#4F46E5",
                orientation: "portrait",
                icons: [
                    {
                        src: "data:image/svg+xml;base64," + btoa(`
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#4F46E5">
                                <path d="M320 96H192L144.6 24.9C137.5 14.2 145.1 0 157.9 0H354.1C366.9 0 374.5 14.2 367.4 24.9L320 96zM192 128H320C373 128 416 171 416 224V448C416 483.3 387.3 512 352 512H160C124.7 512 96 483.3 96 448V224C96 171 139 128 192 128z"/>
                            </svg>
                        `),
                        sizes: "512x512",
                        type: "image/svg+xml"
                    }
                ]
            };

            const manifestBlob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
            const manifestURL = URL.createObjectURL(manifestBlob);
            document.getElementById('manifest-placeholder').href = manifestURL;

            // Show install popup
            setTimeout(() => {
                if (!isAppInstalled()) {
                    document.getElementById('installPopup').style.display = 'flex';
                    document.getElementById('floatingInstall').style.display = 'block';
                    document.getElementById('installBanner').style.display = 'block';
                }
            }, 2000);

            // Install button handlers
            document.getElementById('installBtn').addEventListener('click', handleInstall);
            document.getElementById('installPopupBtn').addEventListener('click', handleInstall);
            document.getElementById('dismissInstall').addEventListener('click', () => {
                document.getElementById('installBanner').style.display = 'none';
            });
            document.getElementById('dismissPopup').addEventListener('click', () => {
                document.getElementById('installPopup').style.display = 'none';
            });
        }

        function isAppInstalled() {
            return window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone === true;
        }

        function handleInstall() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showMessage('Student-Hub installed successfully!', 'success');
                    }
                    deferredPrompt = null;
                });
            } else {
                showMessage('Installation not available. Try adding to home screen manually.', 'info');
            }
        }

        // PWA Install Prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        // Chart Initialization
        function initializeCharts() {
            setTimeout(() => {
                // Department Performance Chart
                const deptCtx = document.getElementById('departmentChart');
                if (deptCtx) {
                    new Chart(deptCtx, {
                        type: 'bar',
                        data: {
                            labels: ['CSE', 'EC', 'ME', 'CE', 'EE'],
                            datasets: [{
                                label: 'Average GPA',
                                data: [3.8, 3.6, 3.4, 3.7, 3.5],
                                backgroundColor: 'rgba(79, 70, 229, 0.8)',
                                borderColor: 'rgba(79, 70, 229, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: { labels: { color: 'white' } }
                            },
                            scales: {
                                y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                                x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                            }
                        }
                    });
                }

                // Grade Distribution Chart
                const gradeCtx = document.getElementById('gradeChart');
                if (gradeCtx) {
                    new Chart(gradeCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['A+', 'A', 'B+', 'B', 'C'],
                            datasets: [{
                                data: [25, 35, 20, 15, 5],
                                backgroundColor: [
                                    'rgba(34, 197, 94, 0.8)',
                                    'rgba(59, 130, 246, 0.8)',
                                    'rgba(168, 85, 247, 0.8)',
                                    'rgba(245, 158, 11, 0.8)',
                                    'rgba(239, 68, 68, 0.8)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: { labels: { color: 'white' } }
                            }
                        }
                    });
                }
            }, 500);
        }

        // Analytics Functions
        function loadAnalytics() {
            // Load AI Predictions
            const predictions = [
                { title: 'Performance Trend', value: '↗️ Improving', color: 'text-green-300' },
                { title: 'Risk Students', value: '3 Students', color: 'text-red-300' },
                { title: 'Top Performers', value: '12 Students', color: 'text-blue-300' }
            ];

            const predictionsHTML = predictions.map(pred => `
                <div class="glass-effect rounded-xl p-4 text-center">
                    <h4 class="text-white font-semibold mb-2">${pred.title}</h4>
                    <div class="text-2xl font-bold ${pred.color}">${pred.value}</div>
                </div>
            `).join('');

            document.getElementById('aiPredictions').innerHTML = predictionsHTML;

            // Initialize analytics charts
            setTimeout(() => {
                const perfCtx = document.getElementById('performanceChart');
                if (perfCtx) {
                    new Chart(perfCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Average Performance',
                                data: [3.2, 3.4, 3.6, 3.5, 3.7, 3.8],
                                borderColor: 'rgba(34, 197, 94, 1)',
                                backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { labels: { color: 'white' } } },
                            scales: {
                                y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                                x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                            }
                        }
                    });
                }

                const attCtx = document.getElementById('attendanceChart');
                if (attCtx) {
                    new Chart(attCtx, {
                        type: 'bar',
                        data: {
                            labels: ['CSE', 'EC', 'ME', 'CE', 'EE'],
                            datasets: [{
                                label: 'Attendance %',
                                data: [85, 82, 88, 86, 84],
                                backgroundColor: 'rgba(59, 130, 246, 0.8)'
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { labels: { color: 'white' } } },
                            scales: {
                                y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                                x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                            }
                        }
                    });
                }
            }, 500);
        }

        // Report Generation
        function generateReport(type) {
            const reportOutput = document.getElementById('reportOutput');
            const reportContent = document.getElementById('reportContent');
            
            let content = '';
            
            if (type === 'student') {
                content = `
                    <h4 class="text-lg font-bold mb-4">Student Report - ${new Date().toLocaleDateString()}</h4>
                    <div class="space-y-2">
                        <p><strong>Total Students:</strong> ${students.length}</p>
                        <p><strong>Active Students:</strong> ${students.length}</p>
                        <p><strong>Departments:</strong> CSE, EC, ME, CE, EE</p>
                        <p><strong>Average GPA:</strong> 3.6</p>
                    </div>
                    <div class="mt-4">
                        <h5 class="font-bold mb-2">Department Breakdown:</h5>
                        <ul class="list-disc list-inside space-y-1">
                            <li>CSE: ${students.filter(s => s.department === 'CSE').length} students</li>
                            <li>EC: ${students.filter(s => s.department === 'EC').length} students</li>
                            <li>ME: ${students.filter(s => s.department === 'ME').length} students</li>
                            <li>CE: ${students.filter(s => s.department === 'CE').length} students</li>
                            <li>EE: ${students.filter(s => s.department === 'EE').length} students</li>
                        </ul>
                    </div>
                `;
            } else if (type === 'performance') {
                content = `
                    <h4 class="text-lg font-bold mb-4">Performance Report - ${new Date().toLocaleDateString()}</h4>
                    <div class="space-y-2">
                        <p><strong>Overall Performance:</strong> Good</p>
                        <p><strong>Top Performers:</strong> ${students.filter(s => s.gpa >= 3.5).length} students</p>
                        <p><strong>Average GPA:</strong> 3.6</p>
                        <p><strong>Improvement Rate:</strong> +12% from last semester</p>
                    </div>
                `;
            } else if (type === 'attendance') {
                content = `
                    <h4 class="text-lg font-bold mb-4">Attendance Report - ${new Date().toLocaleDateString()}</h4>
                    <div class="space-y-2">
                        <p><strong>Overall Attendance:</strong> 85%</p>
                        <p><strong>Best Department:</strong> ME (88%)</p>
                        <p><strong>Students with >90% attendance:</strong> 45</p>
                        <p><strong>Students with <75% attendance:</strong> 8</p>
                    </div>
                `;
            }
            
            reportContent.innerHTML = content;
            reportOutput.style.display = 'block';
            showMessage(`${type.charAt(0).toUpperCase() + type.slice(1)} report generated successfully!`, 'success');
        }

        // Student-specific functions
        function loadStudentGrades() {
            const grades = [
                { subject: 'Data Structures', credits: 4, grade: 'A', points: 4.0 },
                { subject: 'Computer Networks', credits: 3, grade: 'A-', points: 3.7 },
                { subject: 'Database Systems', credits: 4, grade: 'B+', points: 3.3 },
                { subject: 'Software Engineering', credits: 3, grade: 'A', points: 4.0 },
                { subject: 'Web Technologies', credits: 3, grade: 'A+', points: 4.0 }
            ];

            const gradesHTML = grades.map(grade => `
                <tr class="border-b border-white/20 hover:bg-white/10 transition-colors">
                    <td class="p-3">${grade.subject}</td>
                    <td class="p-3">${grade.credits}</td>
                    <td class="p-3"><span class="px-2 py-1 rounded bg-green-600 text-white">${grade.grade}</span></td>
                    <td class="p-3">${grade.points}</td>
                </tr>
            `).join('');

            document.getElementById('gradesTable').innerHTML = gradesHTML;
        }

        function loadStudentAttendance() {
            setTimeout(() => {
                const ctx = document.getElementById('subjectAttendanceChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Data Structures', 'Networks', 'Database', 'Software Eng', 'Web Tech'],
                            datasets: [{
                                label: 'Attendance %',
                                data: [88, 92, 85, 90, 87],
                                backgroundColor: [
                                    'rgba(34, 197, 94, 0.8)',
                                    'rgba(59, 130, 246, 0.8)',
                                    'rgba(168, 85, 247, 0.8)',
                                    'rgba(245, 158, 11, 0.8)',
                                    'rgba(239, 68, 68, 0.8)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { legend: { labels: { color: 'white' } } },
                            scales: {
                                y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                                x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                            }
                        }
                    });
                }
            }, 500);
        }

        function loadStudentAssignments() {
            const assignments = [
                { title: 'Database Design Project', subject: 'Database Systems', dueDate: '2024-01-15', status: 'pending', priority: 'high' },
                { title: 'Network Security Report', subject: 'Computer Networks', dueDate: '2024-01-20', status: 'completed', priority: 'medium' },
                { title: 'Web Application Development', subject: 'Web Technologies', dueDate: '2024-01-10', status: 'overdue', priority: 'high' },
                { title: 'Algorithm Analysis', subject: 'Data Structures', dueDate: '2024-01-25', status: 'pending', priority: 'low' }
            ];

            const assignmentsHTML = assignments.map(assignment => {
                const statusColors = {
                    pending: 'bg-yellow-600',
                    completed: 'bg-green-600',
                    overdue: 'bg-red-600'
                };

                const priorityColors = {
                    high: 'border-red-400',
                    medium: 'border-yellow-400',
                    low: 'border-green-400'
                };

                return `
                    <div class="glass-effect rounded-xl p-4 border-l-4 ${priorityColors[assignment.priority]}">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="text-white font-semibold">${assignment.title}</h4>
                            <span class="px-2 py-1 rounded text-white text-sm ${statusColors[assignment.status]}">
                                ${assignment.status.charAt(0).toUpperCase() + assignment.status.slice(1)}
                            </span>
                        </div>
                        <p class="text-gray-300 text-sm mb-1">${assignment.subject}</p>
                        <p class="text-gray-400 text-sm">Due: ${assignment.dueDate}</p>
                    </div>
                `;
            }).join('');

            document.getElementById('assignmentsList').innerHTML = assignmentsHTML;
        }

        function loadNotifications() {
            const notifications = [
                { title: 'Assignment Due Reminder', message: 'Database Design Project is due in 2 days', time: '2 hours ago', type: 'warning' },
                { title: 'Grade Updated', message: 'Your Computer Networks grade has been updated', time: '1 day ago', type: 'success' },
                { title: 'New Announcement', message: 'Mid-semester exam schedule released', time: '2 days ago', type: 'info' },
                { title: 'Attendance Alert', message: 'Your attendance in Web Technologies is below 75%', time: '3 days ago', type: 'error' }
            ];

            const typeColors = {
                warning: 'bg-yellow-600',
                success: 'bg-green-600',
                info: 'bg-blue-600',
                error: 'bg-red-600'
            };

            const typeIcons = {
                warning: 'fas fa-exclamation-triangle',
                success: 'fas fa-check-circle',
                info: 'fas fa-info-circle',
                error: 'fas fa-times-circle'
            };

            const notificationsHTML = notifications.map(notification => `
                <div class="glass-effect rounded-xl p-4 flex items-start space-x-4">
                    <div class="flex-shrink-0">
                        <div class="w-10 h-10 ${typeColors[notification.type]} rounded-full flex items-center justify-center">
                            <i class="${typeIcons[notification.type]} text-white"></i>
                        </div>
                    </div>
                    <div class="flex-1">
                        <h4 class="text-white font-semibold mb-1">${notification.title}</h4>
                        <p class="text-gray-300 text-sm mb-2">${notification.message}</p>
                        <p class="text-gray-400 text-xs">${notification.time}</p>
                    </div>
                </div>
            `).join('');

            document.getElementById('notificationsList').innerHTML = notificationsHTML;
        }

        // Update recent activities
        function updateRecentActivities() {
            const activities = [
                { action: 'New student registered', user: 'Priya Sharma', time: '5 minutes ago' },
                { action: 'Grade updated', user: 'Rahul Kumar', time: '15 minutes ago' },
                { action: 'Attendance marked', user: 'System', time: '1 hour ago' },
                { action: 'Report generated', user: 'Admin', time: '2 hours ago' }
            ];

            const activitiesHTML = activities.map(activity => `
                <div class="flex items-center justify-between p-3 bg-white/10 rounded-lg">
                    <div>
                        <p class="text-white font-medium">${activity.action}</p>
                        <p class="text-gray-300 text-sm">${activity.user}</p>
                    </div>
                    <span class="text-gray-400 text-sm">${activity.time}</span>
                </div>
            `).join('');

            const container = document.getElementById('recentActivities');
            if (container) {
                container.innerHTML = activitiesHTML;
            }
        }

        console.log('Student-Hub loaded successfully!');
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97a7362f61fa3d25',t:'MTc1NzA5MDg4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
